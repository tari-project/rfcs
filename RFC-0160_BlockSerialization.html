<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>RFC-0160: Block Binary Serialization - The Tari Network: RFC library</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="The Tari network RFC library and documentation">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
            tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
            }
          });
        </script>

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-0Q69T0B1T4"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-0Q69T0B1T4');
        </script>

    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">var path_to_root = "";</script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var sidebar = localStorage.getItem('mdbook-sidebar');
                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme = 'light';
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <img src="theme/images/tari-splash.png" class="tlu">

            <ol class="chapter"><li class="chapter-item expanded affix "><a href="about.html">About the Tari RFC documents</a></li><li class="chapter-item expanded "><a href="RFC-0001_overview.html"><strong aria-hidden="true">1.</strong> RFC-0001: An overview of the Tari network</a></li><li class="chapter-item expanded "><a href="base_layer.html"><strong aria-hidden="true">2.</strong> The Tari Base Layer</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="RFC-0110_BaseNodes.html"><strong aria-hidden="true">2.1.</strong> RFC-0110: Base nodes</a></li><li class="chapter-item expanded "><a href="RFC-0111_BaseNodeArchitecture.html"><strong aria-hidden="true">2.2.</strong> RFC-0111: Base node architecture</a></li><li class="chapter-item expanded "><a href="RFC-0120_Consensus.html"><strong aria-hidden="true">2.3.</strong> RFC-0120: Consensus rules</a></li><li class="chapter-item expanded "><a href="RFC-0131_Mining.html"><strong aria-hidden="true">2.4.</strong> RFC-0131: Mining</a></li><li class="chapter-item expanded "><a href="RFC-0132_Merge_Mining_Monero.html"><strong aria-hidden="true">2.5.</strong> RFC-0132: Merge Mining Monero</a></li><li class="chapter-item expanded "><a href="RFC-0140_Syncing_and_seeding.html"><strong aria-hidden="true">2.6.</strong> RFC-0140: Synchronizing the Blockchain: Archival and Pruned modes</a></li><li class="chapter-item expanded "><a href="RFC-0150_Wallets.html"><strong aria-hidden="true">2.7.</strong> RFC-0150: Wallets</a></li><li class="chapter-item expanded "><a href="RFC-0155_TariAddress.html"><strong aria-hidden="true">2.8.</strong> RFC-0155: TariAddress</a></li><li class="chapter-item expanded "><a href="RFC-0160_BlockSerialization.html" class="active"><strong aria-hidden="true">2.9.</strong> RFC-0160: Block Binary Serialization</a></li><li class="chapter-item expanded "><a href="RFC-0170_NetworkCommunicationProtocol.html"><strong aria-hidden="true">2.10.</strong> RFC-0170: Network Communication Protocol</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="RFC-0171_MessageSerialisation.html"><strong aria-hidden="true">2.10.1.</strong> RFC-0171: Message Serialisation</a></li><li class="chapter-item expanded "><a href="RFC-0172_PeerToPeerMessagingProtocol.html"><strong aria-hidden="true">2.10.2.</strong> RFC-0172: Peer to Peer Messaging Protocol</a></li><li class="chapter-item expanded "><a href="RFC-0173_Versioning.html"><strong aria-hidden="true">2.10.3.</strong> RFC-0173: Versioning</a></li><li class="chapter-item expanded "><a href="RFC-0174_Chat_Metadata.html"><strong aria-hidden="true">2.10.4.</strong> RFC-0174: Chat Metadata</a></li></ol></li><li class="chapter-item expanded "><a href="RFC-0181_BulletproofsPlus.html"><strong aria-hidden="true">2.11.</strong> RFC-0181: Bulletproofs+ range proving</a></li><li class="chapter-item expanded "><a href="RFC-0182_CommitmentSignatures.html"><strong aria-hidden="true">2.12.</strong> RFC-0182: Commitment signatures</a></li><li class="chapter-item expanded "><a href="RFC-0190_Mempool.html"><strong aria-hidden="true">2.13.</strong> RFC-0190: Mempool</a></li><li class="chapter-item expanded "><a href="BaseLayerExtensions.html"><strong aria-hidden="true">2.14.</strong> Tari-specific extensions to Mimblewimble</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="RFC-0201_TariScript.html"><strong aria-hidden="true">2.14.1.</strong> RFC-0201: TariScript</a></li><li class="chapter-item expanded "><a href="RFC-0202_TariScriptOpcodes.html"><strong aria-hidden="true">2.14.2.</strong> RFC-0202: TariScript Opcodes</a></li><li class="chapter-item expanded "><a href="RFC-0204_TariScriptExamples.html"><strong aria-hidden="true">2.14.3.</strong> RFC-0204: TariScript Examples</a></li><li class="chapter-item expanded "><a href="RFC-0203_StealthAddresses.html"><strong aria-hidden="true">2.14.4.</strong> RFC-0203: Stealth Addresses</a></li><li class="chapter-item expanded "><a href="RFC-0205_HardwareTransactions.html"><strong aria-hidden="true">2.14.5.</strong> RFC-0205: Hardware Transactions</a></li><li class="chapter-item expanded "><a href="RFC-0250_Covenants.html"><strong aria-hidden="true">2.14.6.</strong> RFC-0250: Covenants</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="RFC-0303_DanOverview.html"><strong aria-hidden="true">3.</strong> RFC-0303: The Tari Digital Assets Network</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="RFC-0313_VNRegistration.html"><strong aria-hidden="true">3.1.</strong> RFC-0313: Validator Node Registration</a></li><li class="chapter-item expanded "><a href="RFC-0320_TurbineModel.html"><strong aria-hidden="true">3.2.</strong> RFC-0320: The turbine model</a></li><li class="chapter-item expanded "><a href="RFC-0350_TariVM.html"><strong aria-hidden="true">3.3.</strong> RFC-0350: The Tari Virtual Machine</a></li></ol></li><li class="chapter-item expanded "><a href="RFC-0305_Consensus.html"><strong aria-hidden="true">4.</strong> RFC-0305: The Tari Network Consensus Layer</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="RFC-0314_VNCSelection.html"><strong aria-hidden="true">4.1.</strong> RFC-0314: Validator node committee selection</a></li><li class="chapter-item expanded "><a href="RFC-0321_ProcessingForeignProposals.html"><strong aria-hidden="true">4.2.</strong> RFC-0321: Processing foreign proposals</a></li><li class="chapter-item expanded "><a href="RFC-0325_DanTimeManagement.html"><strong aria-hidden="true">4.3.</strong> RFC-0325: Epochs and time management</a></li><li class="chapter-item expanded "><a href="RFC-0330_Cerberus.html"><strong aria-hidden="true">4.4.</strong> RFC-0330: The Cerberus-Hotstuff consensus algorithm</a></li><li class="chapter-item expanded "><a href="RFC-0331_Indexers.html"><strong aria-hidden="true">4.5.</strong> RFC-0331: Indexers</a></li></ol></li><li class="chapter-item expanded "><a href="proposals.html"><strong aria-hidden="true">5.</strong> Proposals and Applications</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="RFC-0123_One_sided_replay_attacks.html"><strong aria-hidden="true">5.1.</strong> RFC-0123: Mitigating One-sided payment replay attacks</a></li><li class="chapter-item expanded "><a href="RFC-0141_Sparse_Merkle_Trees.html"><strong aria-hidden="true">5.2.</strong> RFC-0141: Sparse Merkle Tees</a></li><li class="chapter-item expanded "><a href="RFC-0153_StagedWalletSecurity.html"><strong aria-hidden="true">5.3.</strong> RFC-0153: Staged Wallet Security</a></li><li class="chapter-item expanded "><a href="RFC-0154_DeepLinksConvencion.html"><strong aria-hidden="true">5.4.</strong> RFC-0154: Deep links structure convention</a></li><li class="chapter-item expanded "><a href="RFC-0230_HTLC.html"><strong aria-hidden="true">5.5.</strong> RFC-0230: Hash time locked contracts</a></li><li class="chapter-item expanded "><a href="RFC-0240_AtomicSwap.html"><strong aria-hidden="true">5.6.</strong> RFC-0240: Atomic swap</a></li><li class="chapter-item expanded "><a href="RFC-0241_AtomicSwapXMR.html"><strong aria-hidden="true">5.7.</strong> RFC-0241: XMR Atomic swap</a></li><li class="chapter-item expanded "><a href="RFC-0310_SubmarineSwaps.html"><strong aria-hidden="true">5.8.</strong> RFC-0310: Submarine swaps</a></li><li class="chapter-item expanded "><a href="RFC-0388_BearerTokens.html"><strong aria-hidden="true">5.9.</strong> RFC-0388: Bearer tokens</a></li><li class="chapter-item expanded "><a href="RFC-8001_MultiPartyTransactions.html"><strong aria-hidden="true">5.10.</strong> RFC-8001: Multi-party transactions</a></li><li class="chapter-item expanded "><a href="RFC-8002_TransactionProtocol.html"><strong aria-hidden="true">5.11.</strong> RFC-8002: Transaction protocol</a></li><li class="chapter-item expanded "><a href="RFC-8003_TariUseCases.html"><strong aria-hidden="true">5.12.</strong> RFC-8003: Tari Use Cases</a></li><li class="chapter-item expanded "><a href="RFC-0385_StableCoins.html"><strong aria-hidden="true">5.13.</strong> RFC-0385: Privacy-enabled Stablecoin contract design</a></li><li class="chapter-item expanded "><a href="RFC-0323_TariThrottle.html"><strong aria-hidden="true">5.14.</strong> RFC-0323: Tari throttle exploratory analysis</a></li></ol></li><li class="chapter-item expanded "><a href="deprecated.html"><strong aria-hidden="true">6.</strong> Deprecated RFCs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="RFCD-0010_CodeStructure.html"><strong aria-hidden="true">6.1.</strong> RFC-0010: Tari code structure and organization</a></li><li class="chapter-item expanded "><a href="RFCD-0121_ConsensusEncoding.html"><strong aria-hidden="true">6.2.</strong> RFC-0121: Consensus encoding</a></li><li class="chapter-item expanded "><a href="RFCD-0130_Mining.html"><strong aria-hidden="true">6.3.</strong> RFC-0130: Mining</a></li><li class="chapter-item expanded "><a href="RFCD-0152_EmojiId.html"><strong aria-hidden="true">6.4.</strong> RFCD-0152: Emoji ID</a></li><li class="chapter-item expanded "><a href="RFCD-0180_BulletproofRewinding.html"><strong aria-hidden="true">6.5.</strong> RFC-0180: Bulletproof range proof rewinding</a></li><li class="chapter-item expanded "><a href="RFCD-0300_DAN.html"><strong aria-hidden="true">6.6.</strong> RFC-0300: The Digital Assets Network</a></li><li class="chapter-item expanded "><a href="RFCD-0301_NamespaceRegistration.html"><strong aria-hidden="true">6.7.</strong> RFC-0301: Namespace Registration</a></li><li class="chapter-item expanded "><a href="RFCD-0302_ValidatorNodes.html"><strong aria-hidden="true">6.8.</strong> RFC-0302: Validator Nodes</a></li><li class="chapter-item expanded "><a href="RFCD-0304_VNCommittees.html"><strong aria-hidden="true">6.9.</strong> RFC-0304: Validator Node committee selection</a></li><li class="chapter-item expanded "><a href="RFCD-0306_DANTemplateRegistration.html"><strong aria-hidden="true">6.10.</strong> RFC-0306: DAN Template Registration</a></li><li class="chapter-item expanded "><a href="RFCD-0311_AssetTemplates.html"><strong aria-hidden="true">6.11.</strong> RFC-0311: Digital Asset templates</a></li><li class="chapter-item expanded "><a href="RFCD-0312_DANHighLevelSpecification.html"><strong aria-hidden="true">6.12.</strong> RFC-0312: High level Digital Asset Network Specification</a></li><li class="chapter-item expanded "><a href="RFCD-0322_VNRegistration.html"><strong aria-hidden="true">6.13.</strong> RFC-0322: Validator Node Registration</a></li><li class="chapter-item expanded "><a href="RFCD-0340_VNConsensusOverview.html"><strong aria-hidden="true">6.14.</strong> RFC-0340: Validator Node Consensus</a></li><li class="chapter-item expanded "><a href="RFCD-0341_AssetRegistration.html"><strong aria-hidden="true">6.15.</strong> RFC-0341: Asset registration</a></li><li class="chapter-item expanded "><a href="RFCD-0345_AssetLifeCycle.html"><strong aria-hidden="true">6.16.</strong> RFC-0345: Asset Life cycle</a></li><li class="chapter-item expanded "><a href="RFCD-0360_NFTInvoices.html"><strong aria-hidden="true">6.17.</strong> RFC-0360: NFT sale using MimbleWimble Invoice</a></li><li class="chapter-item expanded "><a href="RFCD-0500_PaymentChannels.html"><strong aria-hidden="true">6.18.</strong> RFC-0500: Tari payment channels</a></li></ol></li><li class="chapter-item expanded "><a href="RFC_template.html"><strong aria-hidden="true">7.</strong> RFC template</a></li><li class="chapter-item expanded "><a href="Glossary.html"><strong aria-hidden="true">8.</strong> Glossary</a></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                        </div>

                        <h1 class="menu-title"><img src="theme/images/tari-horizontal-logo.png"/> </h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="rfc-0160blockserialization"><a class="header" href="#rfc-0160blockserialization">RFC-0160/BlockSerialization</a></h1>
<h2 id="tari-block-binary-serialization"><a class="header" href="#tari-block-binary-serialization">Tari Block Binary Serialization</a></h2>
<p><img src="theme/images/status-stable.svg" alt="status: stable" /></p>
<p><strong>Maintainer(s)</strong>: <a href="https://github.com/sdbondi">Stanley Bondi</a></p>
<h1 id="licence"><a class="header" href="#licence">Licence</a></h1>
<p><a href="https://opensource.org/licenses/BSD-3-Clause">The 3-Clause BSD Licence</a>.</p>
<p>Copyright 2021 The Tari Development Community</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
following conditions are met:</p>
<ol>
<li>Redistributions of this document must retain the above copyright notice, this list of conditions and the following
disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following
disclaimer in the documentation and/or other materials provided with the distribution.</li>
<li>Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products
derived from this software without specific prior written permission.</li>
</ol>
<p>THIS DOCUMENT IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;, AND ANY EXPRESS OR IMPLIED WARRANTIES,
INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
WHETHER IN CONTRACT, STRICT LIABILITY OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
<h2 id="language"><a class="header" href="#language">Language</a></h2>
<p>The keywords &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;, &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;,
&quot;NOT RECOMMENDED&quot;, &quot;MAY&quot; and &quot;OPTIONAL&quot; in this document are to be interpreted as described in
<a href="https://tools.ietf.org/html/bcp14">BCP 14</a> (covering RFC2119 and RFC8174) when, and only when, they appear in all capitals, as
shown here.</p>
<h2 id="disclaimer"><a class="header" href="#disclaimer">Disclaimer</a></h2>
<p>This document and its content are intended for information purposes only and may be subject to change or update
without notice.</p>
<p>This document may include preliminary concepts that may or may not be in the process of being developed by the Tari
community. The release of this document is intended solely for review and discussion by the community of the
technological merits of the potential system outlined herein.</p>
<h2 id="goals"><a class="header" href="#goals">Goals</a></h2>
<p>The aim of this Request for Comment (RFC) is to specify the binary serialization of:</p>
<ol>
<li>a mined Tari block</li>
<li>a Tari block mining template</li>
</ol>
<p>This is to facilitate interoperability of mining software and hardware.</p>
<h2 id="related-requests-for-comment"><a class="header" href="#related-requests-for-comment">Related Requests for Comment</a></h2>
<ul>
<li><a href="RFC-0131_Mining.html">RFC-0131: Full-node Mining on Tari Base Layer</a></li>
</ul>
<h2 id="specification"><a class="header" href="#specification">Specification</a></h2>
<p>By reviewing the <a href="#tari-block-and-mining-template---data-types">block and mining template fields</a> below, we have the 
following underlying data types for serialization:</p>
<ol>
<li><code>bool</code></li>
<li><code>u8</code></li>
<li><code>u16</code></li>
<li><code>u64</code></li>
<li><code>i64</code></li>
<li><code>array</code> of type <code>[u8; n]</code></li>
<li><code>Vec&lt;T&gt;</code> where <code>T</code> is <code>u8</code>, <code>enum</code> or <code>array</code></li>
</ol>
<p>For 1. to 5. and all numbers, <a href="https://developers.google.com/protocol-buffers/docs/encoding#varints">Base 128 Varint</a> encoding MUST be used.</p>
<p>From the Protocol Buffers documentation:</p>
<blockquote>
<p>Varints are a method of serializing integers using one or more bytes. Smaller numbers take a smaller number of bytes. 
Each byte in a varint, except the last byte, has the most significant bit (msb) set â€“ this indicates that there are 
further bytes to come. The lower 7 bits of each byte are used to store the two's complement representation of the 
number in groups of 7 bits, least significant group first.</p>
</blockquote>
<p>For 6. to 7., the dynamically sized <code>array</code> and <code>Vec</code> type, the encoded array MUST be preceded by a number indicating the 
length of the array. This length MUST also be encoded as a varint. By prepending the length of the array, the decoder 
knows how many elements to decode as part of the sequence.</p>
<h2 id="block-field-ordering"><a class="header" href="#block-field-ordering">Block field ordering</a></h2>
<p>Using this varint encoding, all fields of the complete block MUST be encoded in the following order:</p>
<ol>
<li>Version</li>
<li>Height</li>
<li>Previous block hash</li>
<li>Timestamp</li>
<li>Output Merkle root</li>
<li>Witness Merkle root</li>
<li>Output Merkle mountain range size</li>
<li>Kernel Merkle root</li>
<li>Kernel Merkle mountain range size</li>
<li>Input Merkle root</li>
<li>Total kernel offset</li>
<li>Total script offset</li>
<li>Nonce</li>
<li>Proof of work algorithm</li>
<li>Proof of work supplemental data</li>
<li>Transaction inputs - for each input:
<ul>
<li>Version </li>
<li>Spent output - for each output:
<ul>
<li>Version</li>
<li>Features
<ul>
<li>Version</li>
<li>Maturity</li>
<li>Output type</li>
<li>Sidechain features</li>
<li>Metadata</li>
</ul>
</li>
<li>Commitment</li>
<li>Script</li>
<li>Sender offset public key</li>
<li>Covenant</li>
<li>Encrypted value</li>
<li>Minimum value promise</li>
</ul>
</li>
<li>Input data (<a href="https://doc.rust-lang.org/rust-by-example/std/vec.html">vector</a> of Stack items)</li>
<li>Script signature</li>
</ul>
</li>
<li>Transaction outputs - for each output:
<ul>
<li>Version</li>
<li>Features
<ul>
<li>Version</li>
<li>Maturity</li>
<li>Output type</li>
<li>Sidechain features</li>
<li>Metadata</li>
</ul>
</li>
<li>Commitment</li>
<li>Range proof</li>
<li>Script</li>
<li>Sender offset public key</li>
<li>Metadata signature</li>
<li>Covenant</li>
<li>Encrypted value</li>
<li>Minimum value promise</li>
</ul>
</li>
<li>Transaction kernels - for each kernel:
<ul>
<li>Version</li>
<li>Features</li>
<li>Fee</li>
<li>Lock height</li>
<li>Excess</li>
<li>Excess signature public nonce</li>
<li>Excess signature</li>
<li>Burn commitment</li>
</ul>
</li>
</ol>
<h2 id="mining-template-field-ordering"><a class="header" href="#mining-template-field-ordering">Mining template field ordering</a></h2>
<p>The <a href="#new-block-template">new block template</a> is provided to miners to complete. Its fields MUST also be encoded using varints, in the following order:</p>
<ol>
<li>Version</li>
<li>Height</li>
<li>Previous block hash</li>
<li>Total kernel offset</li>
<li>Total script offset</li>
<li>Proof of work algorithm</li>
<li>Proof of work supplemental data</li>
<li>Transaction inputs - for each input:
<ul>
<li>Version</li>
<li>Spent output - for each output:
<ul>
<li>Version</li>
<li>Features
<ul>
<li>Version</li>
<li>Maturity</li>
<li>Output type</li>
<li>Sidechain features</li>
<li>Metadata</li>
</ul>
</li>
<li>Commitment</li>
<li>Script</li>
<li>Sender offset public key</li>
<li>Covenant</li>
<li>Encrypted value</li>
<li>Minimum value promise</li>
</ul>
</li>
<li>Input data (<a href="https://doc.rust-lang.org/rust-by-example/std/vec.html">vector</a> of Stack items)</li>
<li>Script signature</li>
</ul>
</li>
<li>Transaction outputs - for each output:
<ul>
<li>Version</li>
<li>Features
<ul>
<li>Version</li>
<li>Maturity</li>
<li>Output type</li>
<li>Sidechain features</li>
<li>Metadata</li>
</ul>
</li>
<li>Commitment</li>
<li>Range proof</li>
<li>Script</li>
<li>Sender offset public key</li>
<li>Metadata signature</li>
<li>Covenant</li>
<li>Encrypted value</li>
<li>Minimum value promise</li>
</ul>
</li>
<li>Transaction kernels - for each kernel:
<ul>
<li>Version</li>
<li>Features</li>
<li>Fee</li>
<li>Lock height</li>
<li>Excess</li>
<li>Excess signature public nonce</li>
<li>Excess signature</li>
<li>Burn commitment</li>
</ul>
</li>
<li>Target difficulty</li>
<li>Reward</li>
<li>Total fees</li>
</ol>
<h2 id="value-encryption"><a class="header" href="#value-encryption">Value encryption</a></h2>
<p>The value of the value commitment MUST be encrypted using <a href="https://en.wikipedia.org/wiki/ChaCha20-Poly1305">ChaCha20Poly1305</a>
Authenticated Encryption with Additional Data (AEAD). The AEAD key MUST be 32 bytes in size and produced using a
<a href="#hash-domains">domain separated hash</a> of the private key and commitment.</p>
<h2 id="hash-domains"><a class="header" href="#hash-domains">Hash domains</a></h2>
<p>To use a single hash function for producing a sampling of multiple independent hash functions, it's common to employ 
domain separation. Tari uses the <a href="https://github.com/tari-project/tari-crypto/blob/main/src/hashing.rs">hashing API</a> 
within the tari codebase to achieve proper hash domain separation.</p>
<p>The following functional areas MUST each use a separate hash domain that is unique in the tari codebase:</p>
<ul>
<li>kernel Merkle Mointain Range;</li>
<li>witness MMR;</li>
<li>output MMR;</li>
<li>input MMR;</li>
<li>value encryption.</li>
</ul>
<p>To achieve interoperability with other blockchains like Bitcoin and Monero, for example an atomic swap, TariScript MUST 
NOT make use of hash domains.</p>
<h2 id="tari-block-and-mining-template---data-types"><a class="header" href="#tari-block-and-mining-template---data-types">Tari Block and Mining Template - Data Types</a></h2>
<p>A <a href="https://github.com/tari-project/tari/blob/development/base_layer/core/src/blocks/block.rs">Tari block</a> is composed of the <a href="Glossary.html#block-header">block header</a> and <a href="Glossary.html#block-body">aggregate body</a>.</p>
<p>Here we describe the respective Rust types of these fields in the tari codebase, and their underlying data types:</p>
<h3 id="block-header"><a class="header" href="#block-header">Block Header</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Abstract Type</th><th>Data Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Version</td><td><code>u16</code></td><td><code>u16</code></td><td>The Tari protocol version number, used for soft/hard forks</td></tr>
<tr><td>Height</td><td><code>u64</code></td><td><code>u64</code></td><td>Height of this block since the genesis block</td></tr>
<tr><td>Previous Block Hash</td><td><code>BlockHash</code></td><td><code>[u8;32]</code></td><td>Hash of the previous block in the chain</td></tr>
<tr><td>Timestamp</td><td><code>EpochTime</code></td><td><code>u64</code></td><td>Timestamp at which the block was built (number of seconds since Unix epoch)</td></tr>
<tr><td>Output Merkle Root</td><td><code>BlockHash</code></td><td><code>[u8;32]</code></td><td>Merkle Root of the unspent transaction ouputs</td></tr>
<tr><td>Witness Merkle Root</td><td><code>BlockHash</code></td><td><code>[u8;32]</code></td><td>MMR root of the witness proofs</td></tr>
<tr><td>Output MMR Size</td><td><code>u64</code></td><td><code>u64</code></td><td>The size (number of leaves) of the output and range proof MMRs at the time of this header</td></tr>
<tr><td>Kernel Merkle Root</td><td><code>BlockHash</code></td><td><code>[u8;32]</code></td><td>MMR root of the transaction kernels</td></tr>
<tr><td>Kernel MMR Size</td><td><code>u64</code></td><td><code>u64</code></td><td>Number of leaves in the kernel MMR</td></tr>
<tr><td>Input Merkle Root</td><td><code>BlockHash</code></td><td><code>[u8;32]</code></td><td>Merkle Root of the transaction inputs in this block</td></tr>
<tr><td>Total Kernel Offset</td><td><code>BlindingFactor</code></td><td><code>[u8;32]</code></td><td>Sum of kernel offsets for all transaction kernels in this block</td></tr>
<tr><td>Total Script Offset</td><td><code>BlindingFactor</code></td><td><code>[u8;32]</code></td><td>Sum of script offsets for all transaction kernels in this block</td></tr>
<tr><td>Nonce</td><td><code>u64</code></td><td><code>u64</code></td><td>Nonce increment used to mine this block</td></tr>
<tr><td>Pow</td><td><code>ProofOfWork</code></td><td>See <a href="#proof-of-work">Proof Of Work</a></td><td>Proof of Work information</td></tr>
</tbody></table>
</div>
<p><code>[u8;32]</code> indicates an array of 32 unsigned 8-bit integers</p>
<h4 id="proof-of-work"><a class="header" href="#proof-of-work">Proof Of Work</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Abstract Type</th><th>Data Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Proof of Work Algorithm</td><td><code>PowAlgorithm</code></td><td><code>u8</code></td><td>The algorithm used to mine this block ((Monero or SHA3))</td></tr>
<tr><td>Proof of Work Data</td><td><code>Vec&lt;u8&gt;</code></td><td><code>u8</code></td><td>Supplemental proof of work data. For example for Sha3, this would be empty (only the block header is required), but for Monero merge mining we need the Monero block header and RandomX seed hash</td></tr>
</tbody></table>
</div>
<h3 id="block-body"><a class="header" href="#block-body">Block Body</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Abstract Type</th><th>Data Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Sorted</td><td><code>bool</code></td><td><code>bool</code></td><td>True if sorted</td></tr>
<tr><td>Transaction Inputs</td><td><code>Vec&lt;TransactionInput&gt;</code></td><td><code>TransactionInput</code></td><td>List of inputs spent</td></tr>
<tr><td>Transaction Outputs</td><td><code>Vec&lt;TransactionOutput&gt;</code></td><td><code>TransactionOutput</code></td><td>List of outputs produced</td></tr>
<tr><td>Transaction Kernels</td><td><code>Vec&lt;TransactionKernel&gt;</code></td><td><code>TransactionKernel</code></td><td>Kernels contain the excesses and their signatures for the transactions</td></tr>
</tbody></table>
</div>
<p>A further breakdown of the body fields is described below:</p>
<h4 id="transactioninput"><a class="header" href="#transactioninput">TransactionInput</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Abstract Type</th><th>Data Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Version</td><td><code>TransactionInputVersion</code></td><td><code>u16</code></td><td>The features of the output being spent. We will check maturity for all outputs.</td></tr>
<tr><td>Spent Output</td><td><code>SpentOutput</code></td><td>See <a href="#spentoutput">SpentOutput</a></td><td>Either the hash of TransactionOutput that this Input is spending or its data</td></tr>
<tr><td>Input Data</td><td><code>ExecutionStack</code></td><td><code>Vec&lt;u8&gt;</code></td><td>The script input data, maximum size is 512</td></tr>
<tr><td>Script Signature</td><td><code>CommitmentAndPublicKeySignature</code></td><td>See <a href="#commitmentandpublickeysignature">CommitmentAndPublicKeySignature</a></td><td>A signature signing the script and all other transaction input metadata with the script private key</td></tr>
</tbody></table>
</div>
<h5 id="spentoutput"><a class="header" href="#spentoutput">SpentOutput</a></h5>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Abstract Type</th><th>Data Type</th><th>Description</th></tr></thead><tbody>
<tr><td>OutputHash</td><td><code>HashOutput</code></td><td><code>[u8;32]</code></td><td>The features of the output being spent. We will check maturity for all outputs.</td></tr>
<tr><td>Version</td><td><code>TransactionOutputVersion</code></td><td><code>u8</code></td><td>The TransactionOutput version</td></tr>
<tr><td>Features</td><td><code>OutputFeatures</code></td><td>See <a href="#outputfeatures">OutputFeatures</a></td><td>Options for the output's structure or use</td></tr>
<tr><td>Commitment</td><td><code>PedersenCommitment</code></td><td><code>[u8;32]</code></td><td>The commitment referencing the output being spent.</td></tr>
<tr><td>Script</td><td><code>TariScript</code></td><td><code>Vec&lt;u8&gt;</code></td><td>The serialised script, maximum size is 512</td></tr>
<tr><td>Sender Offset Public Key</td><td><code>CommitmentAndPublicKeySignature</code></td><td><code>[u8;32]</code></td><td>The Tari script sender offset public key</td></tr>
<tr><td>Covenant</td><td><code>Vec&lt;CovenantToken&gt;</code></td><td>See <a href="#covenanttoken">CovenantToken</a></td><td>A future-based contract detailing input and output metadata</td></tr>
<tr><td>Encrypted Value</td><td><code>EncryptedValue</code></td><td><code>[u8;24]</code></td><td>The encrypted value of the value commitment</td></tr>
<tr><td>Minimum Value Promise</td><td><code>MicroTari</code></td><td><code>u64</code> <em>(See <a href="#value-encryption">Value encryption</a>)</em></td><td>The minimum value promise embedded in the range proof</td></tr>
</tbody></table>
</div>
<h5 id="commitmentandpublickeysignature"><a class="header" href="#commitmentandpublickeysignature">CommitmentAndPublicKeySignature</a></h5>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Abstract Type</th><th>Data Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Public Nonce</td><td><code>PedersenCommitment</code></td><td><code>[u8;32]</code></td><td>The public (Pedersen) commitment nonce created with the two random nonces</td></tr>
<tr><td><code>u</code></td><td><code>SecretKey</code></td><td><code>[u8;32]</code></td><td>The first publicly known private key of the signature signing with the value</td></tr>
<tr><td><code>v</code></td><td><code>SecretKey</code></td><td><code>[u8;32]</code></td><td>The second publicly known private key of the signature signing with the blinding factor</td></tr>
<tr><td>Public Key</td><td><code>PedersenCommitment</code></td><td><code>[u8;32]</code></td><td>The public nonce of the Schnorr signature</td></tr>
<tr><td><code>a</code></td><td><code>SecretKey</code></td><td><code>[u8;32]</code></td><td>The publicly known private key of the Schnorr signature</td></tr>
</tbody></table>
</div>
<p>Find out more about CommitmentAndPublicKey signatures:</p>
<ul>
<li><a href="https://eprint.iacr.org/2020/061.pdf">Simple Schnorr Signature with Pedersen Commitment as Key</a></li>
<li><a href="https://documents.uow.edu.au/~wsusilo/ZCMS_IJNS08.pdf">A New and Efficient Signature on Commitment Values</a></li>
<li><a href="https://github.com/tari-project/tari-crypto/blob/main/src/signatures/commitment_and_public_key_signature.rs">Tari Commitment and Public Key Signature</a></li>
</ul>
<h5 id="outputfeatures"><a class="header" href="#outputfeatures">OutputFeatures</a></h5>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Abstract Type</th><th>Data Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Version</td><td><code>OutputFeaturesVersion</code></td><td><code>u8</code></td><td>The OutputFeatures version</td></tr>
<tr><td>Output Type</td><td><code>OutputType</code></td><td><code>u8</code></td><td>The type of output</td></tr>
<tr><td>Maturity</td><td><code>u64</code></td><td><code>u64</code></td><td>The block height at which the output can be spent</td></tr>
<tr><td>Metadata</td><td><code>Vec&lt;u8&gt;</code></td><td><code>u8</code></td><td>The block height at which the output can be spent</td></tr>
<tr><td>Side-chain Features</td><td><code>SideChainFeatures</code></td><td><em>none</em></td><td><em>Not implemented</em></td></tr>
</tbody></table>
</div>
<h5 id="covenanttoken"><a class="header" href="#covenanttoken">CovenantToken</a></h5>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Abstract Type</th><th>Data Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Filter</td><td><code>CovenantFilter</code></td><td>See <a href="#covenantfilter">CovenantFilter</a></td><td>The covenant filter</td></tr>
<tr><td>Arg</td><td><code>CovenantArg</code></td><td>See <a href="#covenantarg">CovenantArg</a></td><td>The covenant argument(s)</td></tr>
</tbody></table>
</div>
<h5 id="covenantfilter"><a class="header" href="#covenantfilter">CovenantFilter</a></h5>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Abstract Type</th><th>Data Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Identity</td><td><code>IdentityFilter</code></td><td><em>none</em></td><td>The Identity</td></tr>
<tr><td>And</td><td><code>AndFilter</code></td><td><em>none</em></td><td>And operation</td></tr>
<tr><td>Or</td><td><code>OrFilter</code></td><td><em>none</em></td><td>Or operation</td></tr>
<tr><td>Xor</td><td><code>XorFilter</code></td><td><em>none</em></td><td>Xor operation</td></tr>
<tr><td>Not</td><td><code>NotFilter</code></td><td><em>none</em></td><td>Not operation</td></tr>
<tr><td>Output Hash Equal</td><td><code>OutputHashEqFilter</code></td><td><em>none</em></td><td>Output hash to be equal to</td></tr>
<tr><td>Fields Preserved</td><td><code>FieldsPreservedFilter</code></td><td><em>none</em></td><td>Fields to be preserved</td></tr>
<tr><td>Field Equal</td><td><code>FieldEqFilter</code></td><td><em>none</em></td><td>Field to be equal to</td></tr>
<tr><td>Fields Hashed Equal</td><td><code>FieldsHashedEqFilter</code></td><td><em>none</em></td><td>Fields hashed to be equal to</td></tr>
<tr><td>Absolute Height</td><td><code>AbsoluteHeightFilter</code></td><td><em>none</em></td><td>Absolute height</td></tr>
</tbody></table>
</div>
<h5 id="covenantarg"><a class="header" href="#covenantarg">CovenantArg</a></h5>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Abstract Type</th><th>Data Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Hash</td><td><code>FixedHash</code></td><td><code>[u8;32]</code></td><td>Future hash value</td></tr>
<tr><td>PublicKey</td><td><code>PublicKey</code></td><td><code>[u8;32]</code></td><td>Future public key</td></tr>
<tr><td>Commitment</td><td><code>PedersenCommitment</code></td><td><code>[u8;32]</code></td><td>Future commitment referencing the output being spent.</td></tr>
<tr><td>Tari Script</td><td><code>TariScript</code></td><td><code>Vec&lt;u8&gt;</code></td><td>Future serialised script, maximum size is 512</td></tr>
<tr><td>Covenant</td><td><code>Vec&lt;CovenantToken&gt;</code></td><td>See <a href="#covenanttoken">CovenantToken</a></td><td>Future covenant</td></tr>
<tr><td>Output Type</td><td><code>OutputType</code></td><td><code>u8</code></td><td>Future type of output</td></tr>
<tr><td>Uint</td><td><code>Uint</code></td><td><code>u64</code></td><td>Future value</td></tr>
<tr><td>Output Field</td><td><code>OutputField</code></td><td>See <a href="#outputfield">OutputField</a></td><td>Future set of output fields</td></tr>
<tr><td>OutputFields</td><td><code>Vec&lt;OutputField&gt;</code></td><td>See <a href="#outputfield">OutputField</a></td><td>Future set of output fields</td></tr>
<tr><td>Bytes</td><td><code>Vec&lt;u8&gt;</code></td><td><code>u8</code></td><td>Future raw data</td></tr>
</tbody></table>
</div>
<h5 id="outputfield"><a class="header" href="#outputfield">OutputField</a></h5>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Abstract Type</th><th>Data Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Commitment</td><td><code>u8</code></td><td><code>u8</code></td><td>Commitment byte code</td></tr>
<tr><td>Script</td><td><code>u8</code></td><td><code>u8</code></td><td>Script byte code</td></tr>
<tr><td>Sender Offset Public Key</td><td><code>u8</code></td><td><code>u8</code></td><td>SenderOffsetPublicKey byte code</td></tr>
<tr><td>Covenant</td><td><code>u8</code></td><td><code>u8</code></td><td>Covenant byte code</td></tr>
<tr><td>Features</td><td><code>u8</code></td><td><code>u8</code></td><td>Features byte code</td></tr>
<tr><td>Features Output Type</td><td><code>u8</code></td><td><code>u8</code></td><td>FeaturesOutputType byte code</td></tr>
<tr><td>Features Maturity</td><td><code>u8</code></td><td><code>u8</code></td><td>FeaturesMaturity byte code</td></tr>
<tr><td>Features Metadata</td><td><code>u8</code></td><td><code>u8</code></td><td>FeaturesMetadata byte code</td></tr>
<tr><td>Features Side Chain Features</td><td><code>u8</code></td><td><code>u8</code></td><td>FeaturesSideChainFeatures byte code</td></tr>
</tbody></table>
</div>
<h4 id="transactionoutput"><a class="header" href="#transactionoutput">TransactionOutput</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Abstract Type</th><th>Data Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Version</td><td><code>TransactionOutputVersion</code></td><td><code>u8</code></td><td>The TransactionOutput version</td></tr>
<tr><td>Features</td><td><code>OutputFeatures</code></td><td>See <a href="#outputfeatures">OutputFeatures</a></td><td>Options for the output's structure or use</td></tr>
<tr><td>Commitment</td><td><code>PedersenCommitment</code></td><td><code>[u8;32]</code></td><td>The homomorphic commitment representing the output amount</td></tr>
<tr><td>Proof</td><td><code>RangeProof</code></td><td><code>Vec&lt;u8&gt;</code></td><td>A proof that the commitment is in the right range</td></tr>
<tr><td>Script</td><td><code>TariScript</code></td><td><code>Vec&lt;u8&gt;</code></td><td>The script that will be executed when spending this output</td></tr>
<tr><td>Sender Offset Public Key</td><td><code>PublicKey</code></td><td><code>[u8;32]</code></td><td>The Tari script sender offset public key</td></tr>
<tr><td>Metadata Signature</td><td><code>CommitmentAndPublicKeySignature</code></td><td>See <a href="#commitmentandpublickeysignature">CommitmentAndPublicKeySignature</a></td><td>A signature signing all transaction output metadata with the script offset private key and spending key</td></tr>
<tr><td>Covenant</td><td><code>Vec&lt;CovenantToken&gt;</code></td><td>See <a href="#covenanttoken">CovenantToken</a></td><td>A future-based contract detailing input and output metadata</td></tr>
<tr><td>Encrypted Value</td><td><code>EncryptedValue</code></td><td><code>[u8;24]</code></td><td>The encrypted value of the value commitment</td></tr>
<tr><td>Minimum Value Promise</td><td><code>MicroTari</code></td><td><code>u64</code> <em>(See <a href="#value-encryption">Value encryption</a>)</em></td><td>The minimum value promise embedded in the range proof</td></tr>
</tbody></table>
</div>
<h4 id="transactionkernel"><a class="header" href="#transactionkernel">TransactionKernel</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Abstract Type</th><th>Data Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Version</td><td><code>TransactionKernelVersion</code></td><td><code>u8</code></td><td>The TransactionKernel version</td></tr>
<tr><td>Features</td><td><code>KernelFeatures</code></td><td><code>u8</code></td><td>Options for a kernel's structure or use</td></tr>
<tr><td>Fee</td><td><code>MicroTari</code></td><td><code>u64</code></td><td>Fee originally included in the transaction this proof is for.</td></tr>
<tr><td>Lock Height</td><td><code>u64</code></td><td><code>u64</code></td><td>This kernel is not valid earlier than this height. The max maturity of all inputs to this transaction</td></tr>
<tr><td>Excess</td><td><code>PedersenCommitment</code></td><td><code>[u8;32]</code></td><td>Remainder of the sum of all transaction commitments (minus an offset). If the transaction is well-formed, amounts plus fee will sum to zero, and the excess is a valid public key</td></tr>
<tr><td>Excess Signature</td><td><code>RistrettoSchnorr</code></td><td>See <a href="#ristrettoschnorr">RistrettoSchnorr</a></td><td>An aggregated signature of the metadata in this kernel, signed by the individual excess values and the offset excess of the sender</td></tr>
<tr><td>Burn Commitment</td><td><code>PedersenCommitment</code></td><td><code>[u8;32]</code></td><td>This is an optional field that must be set if the transaction contains a burned output</td></tr>
</tbody></table>
</div>
<h4 id="ristrettoschnorr"><a class="header" href="#ristrettoschnorr">RistrettoSchnorr</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Abstract Type</th><th>Data Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Public nonce</td><td><code>PublicKey</code></td><td><code>[u8;32]</code></td><td>The public nonce of the Schnorr signature</td></tr>
<tr><td>Signature</td><td><code>SecretKey</code></td><td><code>[u8;32]</code></td><td>The signature of the Schnorr signature</td></tr>
</tbody></table>
</div>
<h3 id="new-block-template"><a class="header" href="#new-block-template">New Block Template</a></h3>
<p>The new block template is used in constructing a new partial block, allowing a miner to add the coinbase UTXO and as
a final step for the Base node to add the MMR roots to the header.</p>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Abstract Type</th><th>Data Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Header</td><td><code>NewBlockHeaderTemplate</code></td><td>See <a href="#new-block-header-template">New Block Header Template</a></td><td>The Tari protocol version number, used for soft/hard forks</td></tr>
<tr><td>Body</td><td><code>AggregateBody</code></td><td>See <a href="#block-body">Block Body</a></td><td>Height of this block since the genesis block</td></tr>
<tr><td>Target Difficulty</td><td><code>Difficulty</code></td><td><code>u64</code></td><td>The minimum difficulty required to satisfy the Proof of Work for the block</td></tr>
<tr><td>Reward</td><td><code>MicroTari</code></td><td><code>u64</code></td><td>The value of the emission for the coinbase output for the block</td></tr>
<tr><td>Total Fees</td><td><code>MicroTari</code></td><td><code>u64</code></td><td>The sum of all transaction fees in this block</td></tr>
</tbody></table>
</div>
<h4 id="new-block-header-template"><a class="header" href="#new-block-header-template">New Block Header Template</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Abstract Type</th><th>Data Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Version</td><td><code>u16</code></td><td><code>u16</code></td><td>The Tari protocol version number, used for soft/hard forks</td></tr>
<tr><td>Height</td><td><code>u64</code></td><td><code>u64</code></td><td>Height of this block since the genesis block</td></tr>
<tr><td>Previous Hash</td><td><code>BlockHash</code></td><td><code>[u8;32]</code></td><td>Hash of the previous block in the chain</td></tr>
<tr><td>Total Kernel Offset</td><td><code>BlindingFactor</code></td><td><code>[u8;32]</code></td><td>Total accumulated sum of kernel offsets since genesis block. We can derive the kernel offset sum for <em>this</em> block from the total kernel offset of the previous block header.</td></tr>
<tr><td>Total Script Offset</td><td><code>BlindingFactor</code></td><td><code>[u8;32]</code></td><td>Sum of script offsets for all transaction kernels in this block</td></tr>
<tr><td>Pow</td><td><code>ProofOfWork</code></td><td>See <a href="#proof-of-work">Proof Of Work</a></td><td>Proof of Work information</td></tr>
</tbody></table>
</div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="RFC-0155_TariAddress.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="RFC-0170_NetworkCommunicationProtocol.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a href="RFC-0155_TariAddress.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a href="RFC-0170_NetworkCommunicationProtocol.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <script src=" https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js "></script>
        <script>mermaid.initialize({startOnLoad:true});</script>

        <!-- Custom JS scripts -->


    </body>
</html>
